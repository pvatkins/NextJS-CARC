<!DOCTYPE html>
<html>
<body>

<h1>PayPal Payload Structure</h1>

<p>The computed total is $ <span id ="ctot"></span>.</p>
<p>The first total is $ <span id ="tot1"></span>.</p>
<p>The breakdown total is $ <span id ="tot2"></span>.</p>
<p>The payee email is <span id ="pemail"></span>.</p>
<p>The merchant id is <span id ="merch"></span>.</p>
<script>

  const payload = {
    intent: "CAPTURE", 
    purchase_units: 
    [
      {
        amount: { currency_code: "USD", value: "123.45", 
          breakdown: { "item_total": { value: "123.45", currency_code: "USD" }}},
        reference_id: "AI6BB_001",
        description: "Dues_and_Donations",
        payee:  { email_address: "info@coastsidearc.org", merchant_id: "Coastside ARC" },
        
        items: 
        [
          { name: "2023_Primary_Dues",      unit_amount: { currency_code: "USD",  value: "20.00" }, quantity: "0" }, 
          { name: "2023_Family_Dues",       unit_amount: { currency_code: "USD",  value:  "3.00" }, quantity: "0" }, 
          { name: "2024_Primary_Dues",      unit_amount: { currency_code: "USD",  value: "20.00" }, quantity: "1" }, 
          { name: "2024_Family_Dues",       unit_amount: { currency_code: "USD",  value:  "3.00" }, quantity: "1" }, 
          { name: "2025_Primary_Dues",      unit_amount: { currency_code: "USD",  value: "20.00" }, quantity: "1" }, 
          { name: "2025_Family_Dues",       unit_amount: { currency_code: "USD",  value:  "3.00" }, quantity: "1" },  
          { name: "2026_Primary_Dues",      unit_amount: { currency_code: "USD",  value: "20.00" }, quantity: "0" }, 
          { name: "2026_Family_Dues",       unit_amount: { currency_code: "USD",  value:  "3.00" }, quantity: "0" },  
          { name: "Repeater_Fund",          unit_amount: { currency_code: "USD",  value: "32.65" }, quantity: "1" }, 
          { name: "Digipeater_and_APRS",    unit_amount: { currency_code: "USD",  value: "40.00" }, quantity: "1" },
          { name: "Estimated_Paypal_Fees",  unit_amount: { currency_code: "USD",  value:  "4.80" }, quantity: "1" } 
        ],
        
      },
    ],
  };
  let myTotal = 0.0;
  for (let ix=0; ix < payload.purchase_units[0].items.length; ix++) {
    ref = payload.purchase_units[0].items[ix];
    qty = Number(ref.quantity);
    val = Number(ref.unit_amount.value);
    myTotal = myTotal + qty * val;
  }
  myRefTotal = Number(payload.purchase_units[0].amount.value);
  mybkdnTotal = Number(payload.purchase_units[0].amount.breakdown.item_total.value);
  document.getElementById("ctot").innerHTML = myTotal;
  document.getElementById("tot1").innerHTML = myTotal;
  document.getElementById("tot2").innerHTML = myTotal;
  payref = payload.purchase_units[0].payee;
  document.getElementById("pemail").innerHTML = payref.email_address;
  document.getElementById("merch").innerHTML = payref.merchant_id;
</script>

</body>
</html>
